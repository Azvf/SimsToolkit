<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:SimsModDesktop.ViewModels"
             xmlns:panelVm="clr-namespace:SimsModDesktop.ViewModels.Panels"
             x:Class="SimsModDesktop.Views.Panels.MergePanelView"
             x:DataType="vm:MainWindowViewModel">
    <Border Classes="card-muted" Padding="10" IsVisible="{Binding IsMergeVisible}">
        <StackPanel Spacing="10">
            <StackPanel Spacing="2">
                <TextBlock Classes="section-title" Text="Merge Directories" />
                <TextBlock Classes="helper-text" Text="One source directory per row; use + and - for quick add/remove." />
            </StackPanel>

            <Border Classes="card" Padding="10">
                <StackPanel Spacing="8">
                    <TextBlock Classes="sub-title" Text="Source Directories" />
                    <ScrollViewer MaxHeight="220"
                                  HorizontalScrollBarVisibility="Disabled"
                                  VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding Merge.SourcePaths}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="panelVm:MergeSourcePathEntryViewModel">
                                    <Grid Margin="0,0,0,8" ColumnDefinitions="*,Auto,Auto,Auto" ColumnSpacing="8">
                                        <TextBox Grid.Column="0"
                                                 Classes="path-field"
                                                 Text="{Binding Path}"
                                                 Watermark="Select source directory path" />
                                        <Button Grid.Column="1"
                                                MinWidth="82"
                                                Content="Browse"
                                                Command="{Binding $parent[UserControl].DataContext.BrowseMergeSourcePathCommand}"
                                                CommandParameter="{Binding}" />
                                        <Button Grid.Column="2"
                                                Width="32"
                                                Height="32"
                                                FontWeight="Bold"
                                                Content="+"
                                                Command="{Binding $parent[UserControl].DataContext.AddMergeSourcePathCommand}"
                                                CommandParameter="{Binding}" />
                                        <Button Grid.Column="3"
                                                Width="32"
                                                Height="32"
                                                FontWeight="Bold"
                                                Content="-"
                                                Command="{Binding $parent[UserControl].DataContext.RemoveMergeSourcePathCommand}"
                                                CommandParameter="{Binding}" />
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </StackPanel>
            </Border>

            <Grid ColumnDefinitions="180,*,Auto" RowDefinitions="Auto" RowSpacing="8" ColumnSpacing="8">
                <TextBlock Grid.Row="0" VerticalAlignment="Center" Text="Target Directory" />
                <TextBox Grid.Row="0" Grid.Column="1" Classes="path-field" Text="{Binding Merge.TargetPath}" />
                <Button Grid.Row="0" Grid.Column="2" Content="Browse" Command="{Binding BrowseFolderCommand}" CommandParameter="MergeTargetPath" />
            </Grid>
        </StackPanel>
    </Border>
</UserControl>

