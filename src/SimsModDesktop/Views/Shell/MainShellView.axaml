<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:shell="clr-namespace:SimsModDesktop.ViewModels.Shell"
             xmlns:saves="clr-namespace:SimsModDesktop.Views.Saves"
             xmlns:workspace="clr-namespace:SimsModDesktop.Views.Workspace"
             mc:Ignorable="d"
             x:Class="SimsModDesktop.Views.Shell.MainShellView"
             x:DataType="shell:MainShellViewModel">
    <Grid x:Name="ShellRoot"
          Focusable="True"
          PointerPressed="OnShellPointerPressed">
        <Grid Margin="14" ColumnDefinitions="230,*" ColumnSpacing="12" RowDefinitions="*" MinHeight="0">
        <Border Classes="sidebar-shell" Padding="12">
            <Grid RowDefinitions="Auto,Auto,*,Auto" RowSpacing="10">
                <StackPanel Spacing="2">
                    <TextBlock Classes="sidebar-kicker" Text="SimsToolkit" />
                    <TextBlock Classes="sidebar-minimal-title" Text="Workspace" />
                </StackPanel>

                <Border Grid.Row="1"
                        Classes="sidebar-subtle-block"
                        Classes.path-health-interactive="{Binding IsPathHealthExpanded}"
                        Padding="8"
                        IsHitTestVisible="{Binding IsPathHealthExpanded}"
                        PointerPressed="OnPathHealthPointerPressed">
                    <Grid>
                        <Grid ColumnDefinitions="*,Auto"
                              RowDefinitions="Auto,Auto,Auto,Auto"
                              ColumnSpacing="8"
                              RowSpacing="6"
                              IsVisible="{Binding IsPathHealthExpanded}">
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <Border Classes="status-dot"
                                        Classes.status-ok="{Binding HasGameExecutable}"
                                        Classes.status-warning="{Binding IsGameExecutableWarning}"
                                        Classes.status-missing="{Binding IsGameExecutableMissing}" />
                                <TextBlock VerticalAlignment="Center" Text="Game" />
                            </StackPanel>
                            <Border Grid.Row="0"
                                    Grid.Column="1"
                                    Classes="status-pill"
                                    Classes.status-ok="{Binding HasGameExecutable}"
                                    Classes.status-warning="{Binding IsGameExecutableWarning}"
                                    Classes.status-missing="{Binding IsGameExecutableMissing}">
                                <TextBlock Classes="status-pill-text" Text="{Binding GameStatusBadgeText}" />
                            </Border>

                            <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <Border Classes="status-dot"
                                        Classes.status-ok="{Binding HasModsPath}"
                                        Classes.status-warning="{Binding IsModsPathWarning}"
                                        Classes.status-missing="{Binding IsModsPathMissing}" />
                                <TextBlock VerticalAlignment="Center" Text="Mods" />
                            </StackPanel>
                            <Border Grid.Row="1"
                                    Grid.Column="1"
                                    Classes="status-pill"
                                    Classes.status-ok="{Binding HasModsPath}"
                                    Classes.status-warning="{Binding IsModsPathWarning}"
                                    Classes.status-missing="{Binding IsModsPathMissing}">
                                <TextBlock Classes="status-pill-text" Text="{Binding ModsStatusBadgeText}" />
                            </Border>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <Border Classes="status-dot"
                                        Classes.status-ok="{Binding HasTrayPath}"
                                        Classes.status-warning="{Binding IsTrayPathWarning}"
                                        Classes.status-missing="{Binding IsTrayPathMissing}" />
                                <TextBlock VerticalAlignment="Center" Text="Tray" />
                            </StackPanel>
                            <Border Grid.Row="2"
                                    Grid.Column="1"
                                    Classes="status-pill"
                                    Classes.status-ok="{Binding HasTrayPath}"
                                    Classes.status-warning="{Binding IsTrayPathWarning}"
                                    Classes.status-missing="{Binding IsTrayPathMissing}">
                                <TextBlock Classes="status-pill-text" Text="{Binding TrayStatusBadgeText}" />
                            </Border>

                            <StackPanel Grid.Row="3" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <Border Classes="status-dot"
                                        Classes.status-ok="{Binding HasSavesPath}"
                                        Classes.status-warning="{Binding IsSavesPathWarning}"
                                        Classes.status-missing="{Binding IsSavesPathMissing}" />
                                <TextBlock VerticalAlignment="Center" Text="Saves" />
                            </StackPanel>
                            <Border Grid.Row="3"
                                    Grid.Column="1"
                                    Classes="status-pill"
                                    Classes.status-ok="{Binding HasSavesPath}"
                                    Classes.status-warning="{Binding IsSavesPathWarning}"
                                    Classes.status-missing="{Binding IsSavesPathMissing}">
                                <TextBlock Classes="status-pill-text" Text="{Binding SavesStatusBadgeText}" />
                            </Border>
                        </Grid>

                        <Grid ColumnDefinitions="Auto,*,Auto"
                              ColumnSpacing="8"
                              IsVisible="{Binding HasAllCorePathsValid}">
                            <Border Classes="status-dot status-ok"
                                    VerticalAlignment="Center" />
                            <TextBlock Grid.Column="1"
                                       VerticalAlignment="Center"
                                       Text="Core Paths" />
                            <Border Grid.Column="2"
                                    Classes="status-pill status-ok">
                                <TextBlock Classes="status-pill-text success-text" Text="Valid" />
                            </Border>
                        </Grid>
                    </Grid>
                </Border>

                <ScrollViewer Grid.Row="2" MinHeight="0" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="6">
                        <Button Classes="sidebar-link-minimal"
                                Classes.sidebar-active="{Binding IsToolkitSectionSelected}"
                                VerticalContentAlignment="Center"
                                HorizontalContentAlignment="Left"
                                Command="{Binding SelectSectionCommand}"
                                CommandParameter="Toolkit"
                                Content="Toolkit" />
                        <Button Classes="sidebar-link-minimal"
                                Classes.sidebar-active="{Binding IsModsSectionSelected}"
                                VerticalContentAlignment="Center"
                                HorizontalContentAlignment="Left"
                                Command="{Binding SelectSectionCommand}"
                                CommandParameter="Mods"
                                Content="Mods" />
                        <Button Classes="sidebar-link-minimal"
                                Classes.sidebar-active="{Binding IsTraySectionSelected}"
                                VerticalContentAlignment="Center"
                                HorizontalContentAlignment="Left"
                                Command="{Binding SelectSectionCommand}"
                                CommandParameter="Tray"
                                Content="Tray" />
                        <Button Classes="sidebar-link-minimal"
                                Classes.sidebar-active="{Binding IsSavesSectionSelected}"
                                VerticalContentAlignment="Center"
                                HorizontalContentAlignment="Left"
                                Command="{Binding SelectSectionCommand}"
                                CommandParameter="Saves"
                                Content="Saves" />
                        <Button Classes="sidebar-link-minimal"
                                Classes.sidebar-active="{Binding IsSettingsSectionSelected}"
                                VerticalContentAlignment="Center"
                                HorizontalContentAlignment="Left"
                                Command="{Binding SelectSectionCommand}"
                                CommandParameter="Settings"
                                Content="Settings" />
                    </StackPanel>
                </ScrollViewer>

                <Button Grid.Row="3"
                        Classes="primary sidebar-launch-minimal"
                        Height="42"
                        VerticalContentAlignment="Center"
                        HorizontalContentAlignment="Center"
                        Content="{Binding LaunchButtonText}"
                        IsEnabled="{Binding CanLaunchGame}"
                        Command="{Binding LaunchGameCommand}" />
            </Grid>
        </Border>

        <Grid Grid.Column="1" MinHeight="0">
            <Grid MinHeight="0">
                <Border Classes="card" Padding="12" IsVisible="{Binding IsSavesVisible}">
                    <saves:SavesView DataContext="{Binding SavesVm}" />
                </Border>

                <Border Classes="card" Padding="12" IsVisible="{Binding IsSettingsVisible}">
                    <StackPanel Spacing="12">
                        <TextBlock Classes="section-title" Text="Settings" />

                        <Border Classes="settings-section" Padding="12">
                            <StackPanel Spacing="10">
                                <StackPanel Spacing="2">
                                    <TextBlock Classes="settings-section-title" Text="Game Paths" />
                                    <TextBlock Classes="settings-section-description"
                                               Text="Set The Sims 4 Root. Game, Mods, Tray and Saves paths are derived automatically." />
                                </StackPanel>

                                <Grid Classes="settings-path-grid"
                                      ColumnDefinitions="220,*,Auto"
                                      RowDefinitions="Auto,Auto,Auto,Auto,Auto"
                                      RowSpacing="8"
                                      ColumnSpacing="8">
                                    <TextBlock Classes="settings-field-label" Text="The Sims 4 Root" />
                                    <TextBox x:Name="Ts4RootPathTextBox"
                                             Grid.Column="1"
                                             Classes="path-field"
                                             Text="{Binding Ts4RootPath}" />
                                    <Button Grid.Column="2"
                                            Classes="secondary"
                                            Content="Browse"
                                            Command="{Binding BrowseTs4RootCommand}" />

                                    <TextBlock Grid.Row="1" Classes="settings-field-label" Text="Game Executable" />
                                    <Border Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Classes="settings-readonly-field">
                                        <TextBlock Classes="settings-readonly-value" Text="{Binding GameExecutablePath}" />
                                    </Border>

                                    <TextBlock Grid.Row="2" Classes="settings-field-label" Text="Mods Path" />
                                    <Border Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Classes="settings-readonly-field">
                                        <TextBlock Classes="settings-readonly-value" Text="{Binding ModsPath}" />
                                    </Border>

                                    <TextBlock Grid.Row="3" Classes="settings-field-label" Text="Tray Path" />
                                    <Border Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2" Classes="settings-readonly-field">
                                        <TextBlock Classes="settings-readonly-value" Text="{Binding TrayPath}" />
                                    </Border>

                                    <TextBlock Grid.Row="4" Classes="settings-field-label" Text="Saves Path" />
                                    <Border Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" Classes="settings-readonly-field">
                                        <TextBlock Classes="settings-readonly-value" Text="{Binding SavesPath}" />
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <Border Classes="settings-section" Padding="12">
                            <StackPanel Spacing="10">
                                <StackPanel Spacing="2">
                                    <TextBlock Classes="settings-section-title" Text="Appearance" />
                                    <TextBlock Classes="settings-section-description"
                                               Text="Choose application theme." />
                                </StackPanel>

                                <Grid ColumnDefinitions="220,*" RowDefinitions="Auto" RowSpacing="8" ColumnSpacing="8">
                                    <TextBlock VerticalAlignment="Center" Text="Theme" />
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                                        <Button Classes="secondary"
                                                Classes.sidebar-active="{Binding IsDarkThemeSelected}"
                                                Content="Dark"
                                                Command="{Binding SetDarkThemeCommand}" />
                                        <Button Classes="secondary"
                                                Classes.sidebar-active="{Binding IsLightThemeSelected}"
                                                Content="Light"
                                                Command="{Binding SetLightThemeCommand}" />
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <Border Classes="settings-section" Padding="12">
                            <StackPanel Spacing="10">
                                <StackPanel Spacing="2">
                                    <TextBlock Classes="settings-section-title" Text="Cache" />
                                    <TextBlock Classes="settings-section-description"
                                               Text="Clear on-disk thumbnail and metadata caches. Restart the app to fully drop in-memory caches." />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <Button Classes="secondary"
                                            Content="Clear Cache"
                                            Command="{Binding ClearCacheCommand}" />
                                    <TextBlock VerticalAlignment="Center"
                                               Classes="helper-text"
                                               Text="{Binding CacheMaintenanceStatus}" />
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <Grid IsVisible="{Binding IsWorkspaceSectionVisible}" MinHeight="0">
                    <workspace:WorkspaceView DataContext="{Binding WorkspaceVm}" MinHeight="0" />
                </Grid>
            </Grid>

        </Grid>

        </Grid>
    </Grid>
</UserControl>

